# JohnTech System Security Configuration
# XAMPP Compatible Version

# Security Headers (only if mod_headers is available)
<IfModule mod_headers.c>
    Header always set X-Frame-Options "DENY"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# Hide sensitive files - Compatible with Apache 2.2 and 2.4
<Files "config.php">
    Order allow,deny
    Deny from all
</Files>

<Files "composer.json">
    Order allow,deny
    Deny from all
</Files>

<Files "composer.lock">
    Order allow,deny
    Deny from all
</Files>

<Files "*.sql">
    Order allow,deny
    Deny from all
</Files>

# Protect includes directory
<Files "includes/*.php">
    Order allow,deny
    Deny from all
</Files>

# Disable directory browsing
Options -Indexes

# Custom 404 error page
ErrorDocument 404 /handlers/404_handler.php

# Prevent access to backup files
<FilesMatch "\.(bak|backup|old|orig|save|swp|tmp)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Basic security settings
<IfModule mod_php.c>
    php_flag display_errors Off
    php_flag log_errors On
    php_flag expose_php Off
</IfModule>
